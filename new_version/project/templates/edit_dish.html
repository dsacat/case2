{% extends 'layout.html' %}
{% block content %}
<section class="form-shell anim-fade-in anim-delay-2">
    <form class="form-card wide" method="POST" action="/dish/{{ dish.id }}/edit/">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        <h1>Редактирование блюда</h1>
        <div class="field"><label>Название</label><input class="input-styled" name="dish_title" maxlength="220" value="{{ dish.title }}" required></div>
        <div class="field"><label>Описание</label><textarea class="input-styled" name="dish_description" maxlength="2000" required>{{ dish.description }}</textarea></div>
        <div class="field"><label>Состав</label><textarea class="input-styled" name="dish_composition" maxlength="2000" required>{{ dish.composition }}</textarea></div>
        <div class="field"><label>Аллергены</label><input type="text" name="allergens" maxlength="500" class="input-styled" value="{{ dish.allergens | default('') }}" placeholder="глютен, лактоза, орехи (через запятую)"></div>
        <div class="field"><label>Категория</label>
            <select class="input-styled" name="dish_category">
                {% for key, title in categories.items() %}
                <option value="{{ key }}" {% if dish.category == key %}selected{% endif %}>{{ title }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="field-grid">
            <div class="field"><label>Группа меню</label>
                <select class="input-styled" name="dish_group_id">
                    <option value="0" {% if not dish.dish_group_id %}selected{% endif %}>Без группы</option>
                    {% for row in dish_groups %}
                    <option value="{{ row.id }}" {% if dish.dish_group_id == row.id %}selected{% endif %}>{{ row.title }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <div class="field-grid four">
            <div class="field"><label>Масса, г</label><input class="input-styled" type="number" step="0.1" min="0" name="dish_mass" value="{{ dish.mass_grams }}"></div>
            <div class="field"><label>Ккал</label><input class="input-styled" type="number" step="0.1" min="0" name="dish_kcal" value="{{ dish.calories }}"></div>
            <div class="field"><label>Белки</label><input class="input-styled" type="number" step="0.1" min="0" name="dish_proteins" value="{{ dish.proteins }}"></div>
            <div class="field"><label>Жиры</label><input class="input-styled" type="number" step="0.1" min="0" name="dish_fats" value="{{ dish.fats }}"></div>
        </div>
        <div class="field-grid">
            <div class="field"><label>Углеводы</label><input class="input-styled" type="number" step="0.1" min="0" name="dish_carbs" value="{{ dish.carbohydrates }}"></div>
            <div class="field"><label>Цена, ₽</label><input class="input-styled" type="number" min="0" step="1" name="dish_price" value="{{ dish.price }}"></div>
        </div>
        <div class="top-actions">
            <button class="btn btn-primary" type="submit">Сохранить изменения</button>
            <a class="btn btn-primary" href="/dish/{{ dish.id }}/">Отмена</a>
        </div>
    </form>
</section>
{% endblock %}
